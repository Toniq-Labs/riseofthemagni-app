function launchAdventure(e,t){chapter=e,scene=t,processNextScene()}function processNextScene(e){if(scene>=CONFIG.adventure[chapter].length)rooms.menu.enter();else{var t=CONFIG.adventure[chapter][scene];switch(e||rooms.adventure.scene.clear(),t.type){case"title":rooms.adventure.scene.text(t.title).font(CONFIG.fonts.title).translate(600,200).fill("white"),void 0!==t.backgroundColor?setBackgroundColor(t.backgroundColor):setBackgroundColor(),void 0!==t.background?setBackground(t.background):setBackground(),void 0!==t.subtitle&&rooms.adventure.scene.text(t.subtitle).font(CONFIG.fonts.subtitle).translate(600,300).fill("white"),fadeToNextEvent(t.delay);break;case"overlay":void 0!==t.backgroundColor&&setBackgroundColor(t.backgroundColor),setBackground(t.background),fadeToNextEvent(t.delay);break;case"chat":inchat?(chatnp.clear(),chatnp.opacity(1)):(inchat=!0,rooms.adventure.scene.image("assets/chat_bg.png").translate(25,625),chatnp=rooms.adventure.scene.group());var a=450;void 0===t.side||"left"==t.side?chatnp.image(CONFIG.characters[t.character].image).translate(0,570):(a=80,chatnp.image(CONFIG.characters[t.character].image).flip("x").translate(1200,570)),chatnp.text(CONFIG.characters[t.character].name+": "+t.text).font(CONFIG.fonts.chat).translate(a,670).fill("black"),rooms.adventure.clickHandler=()=>{rooms.adventure.clickHandler=!1,CONFIG.adventure[chapter][scene+1]&&"chat"==CONFIG.adventure[chapter][scene+1].type?chatnp.animate().opacity(0).after((()=>{scene++,processNextScene(!0)})):(inchat=!1,chatnp.clear(),fadeToNextEvent())};break;case"battle":void 0!==t.backgroundColor?setBackgroundColor(t.backgroundColor):setBackgroundColor("white"),void 0!==t.background?setBackground(t.background):setBackground("assets/bg.jpg"),void 0===t.board&&(t.board="standard");var r=t.board;"string"==typeof r&&(r=CONFIG.boards[r]);var o=e=>{fadeToBlack((()=>{rooms.adventure.enter(),rooms.adventure.scene.clear(),setBackgroundColor(),setBackground(),fadeFromBlack((()=>{var a,r="next",o="back",n="back";if(void 0!==t.result&&(void 0!==t.result.win&&(r=t.result.win),void 0!==t.result.lose&&(o=t.result.lose),void 0!==t.result.draw&&(n=t.result.draw)),1==e?(rooms.adventure.scene.text("YOU WON").font(CONFIG.fonts.title).translate(600,200).fill("white"),a=r):2==e?(rooms.adventure.scene.text("DRAW").font(CONFIG.fonts.title).translate(600,200).fill("white"),a=n):(rooms.adventure.scene.text("DEFEATED").font(CONFIG.fonts.title).translate(600,200).fill("white"),a=o),"next"==a)fadeToNextEvent(1);else if("back"==a)scene-=2,fadeToNextEvent(1);else{var c=a[1];"back"==a[0]?(scene-=c+2,fadeToNextEvent(1)):"next"==a[0]?(scene+=c,fadeToNextEvent(1)):"goto"==a[0]&&(scene=c,fadeToNextEvent(1))}}))}))},n=t.cards.slice();void 0!==t.character?rooms.game.enter(0,"Continue",o,n,r,t.character):rooms.game.enter(0,"Continue",o,n,r)}}}