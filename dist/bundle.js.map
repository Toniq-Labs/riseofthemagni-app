{"version":3,"sources":["webpack://rotm_v2/webpack/runtime/chunk loaded","webpack://rotm_v2/./src/extjs.js","webpack://rotm_v2/./src/rotm.did.js","webpack://rotm_v2/./src/main.js","webpack://rotm_v2/webpack/bootstrap","webpack://rotm_v2/webpack/runtime/amd options","webpack://rotm_v2/webpack/runtime/compat get default export","webpack://rotm_v2/webpack/runtime/define property getters","webpack://rotm_v2/webpack/runtime/global","webpack://rotm_v2/webpack/runtime/hasOwnProperty shorthand","webpack://rotm_v2/webpack/runtime/make namespace object","webpack://rotm_v2/webpack/runtime/node module decorator","webpack://rotm_v2/webpack/runtime/jsonp chunk loading","webpack://rotm_v2/webpack/startup"],"names":["deferred","_preloadedIdls","ExtConnection","_mapIdls","_identity","_host","_agent","_canisters","constructor","host","identity","this","_makeAgent","idl","canister","setIdentity","setHost","cid","hasOwnProperty","Error","agent","canisterId","args","idlFactory","IDL","HexNeighbors","Tuple","Opt","Nat","BoardHex","Record","Nat8","Board","Vec","Text","BoardId","Nat32","MagniAttack","Magni","MagniId","MagniNFTId","ItemId","MagniNFT","Bool","GameHash","OpponentId","GameOption","Variant","GameId","GameScore","GameResult","Principal","GameStatus","Null","GameState","Response","Move","PlayerMove","GameData","Service","Func","AUTH","logintype","openlogin","clientId","network","uxMode","async","unloadROTM","ROTM","gameLeave","showLoader","imgs","i","length","Image","src","preload","document","addEventListener","API","init","GD","getGameData","magni","CONFIG","push","name","concat","attack","boards","toLowerCase","hexs","map","a","coords","offsetX","offsetY","currentRoom","click","hideLoader","rooms","login","enter","window","e","onbeforeunload","currentSound","bgmuted","mute","updateGameState","gs","_intv","state","status","game","SOUND","alert","play","_stopPolling","gameState","lead","isPlayer1","drawMessage","selectedHex","unhighlight","clear","currentPlayer","otherPlayer","moves","isPlayersTurn","ended","noresult","backButton","show","win","scoreMsg","lose","bgmusic","movesMade","p","gamegrid","isPlayerHex","place","colors","ally","enemy","placeHex","drawScore","fromHexString","hex","substr","bytes","c","parseInt","_gameState","_gameId","_clearPolling","clearInterval","_startPolling","setInterval","gamePoll","then","r","ok","console","log","err","inGame","gameFind","roster","poll","Promise","resolve","reject","mids","m","resp","catch","gameJoin","id","gameCreate","pvp","gamePractise","practice","gameMove","position","gameEnd","connect","mymagni","stats","draw","INNERDRAW","group","exit","getIdentity","getPrincipal","toString","setTimeout","menu","privKey","Uint8Array","setBackground","createButton","maxTimeToLive","BigInt","identityProvider","onSuccess","onError","open","focus","lobby","settings","logout","msfx","umsfx","mbg","umbg","select","hide","sfxmuted","adventure","chapter","stage","scene","clickHandler","inAdventureMode","s","launchAdventure","headerMessage","hexClickHandler","buttonIsFree","x","y","type","playergrid","set","hexBg","removeCard","updateSelectedTeam","herogrid","magnitomove","pop","starters","indexOf","drawCurrentRating","gameMode","gm","createBtn","joinBtn","playOnlineBtn","backBtn","cancelBtn","isValidTeam","selectedTeam","finally","makeid","prompt","premadegrid","special","omd","rd","highlight","player","index","character","board","result","playerScore","opponentScore","bbt","bbfn","localScore","standard","Grid","st1","st2","Howl","battle","volume","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","loaded","__webpack_modules__","call","amdO","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","Object","keys","every","key","splice","n","getter","__esModule","d","definition","o","defineProperty","enumerable","get","g","globalThis","Function","obj","prop","prototype","Symbol","toStringTag","value","nmd","paths","children","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","data","moreModules","runtime","chunkLoadingGlobal","self","forEach","bind","__webpack_exports__"],"mappings":"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","file":"bundle.js","sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","/* global BigInt */\r\nimport { Actor, HttpAgent } from \"@dfinity/agent\";  \r\n\r\n//Preload IDLS against a common name\r\nconst _preloadedIdls = {\r\n\r\n};\r\n\r\nclass ExtConnection {\r\n  _mapIdls = {\r\n  };\r\n\r\n  _identity = false;\r\n  _host = false;\r\n  _agent = false;\r\n  _canisters = {};\r\n  \r\n  constructor(host, identity) {\r\n    if (identity) this._identity = identity;\r\n    if (host) this._host = host;\r\n    this._makeAgent();\r\n  }\r\n  idl(canister, idl) {\r\n    this._mapIdls[canister] = idl;\r\n    return this;\r\n  };\r\n  setIdentity(identity) {\r\n    if (identity) this._identity = identity;\r\n    else this._identity = false;\r\n    this._makeAgent();\r\n    return this;\r\n  }\r\n  setHost(host) {\r\n    if (host) this._host = host;\r\n    else this._host = false;\r\n    this._makeAgent();\r\n    return this;\r\n  }\r\n  canister(cid, idl) {\r\n    if (!idl){\r\n      if (this._mapIdls.hasOwnProperty(cid)) {\r\n        idl = this._mapIdls[cid];\r\n      } else {\r\n        throw new Error(idl + \" is not a preloaded IDL\");\r\n      }\r\n    } else if (typeof idl == 'string') {\r\n      if (_preloadedIdls.hasOwnProperty(idl)) {\r\n        idl = _preloadedIdls[idl];\r\n      } else {\r\n        throw new Error(idl + \" is not a preloaded IDL\");\r\n      }\r\n    }\r\n    if (!this._canisters.hasOwnProperty(cid)){\r\n      this._canisters[cid] = Actor.createActor(idl, {agent : this._agent, canisterId : cid});\r\n    }\r\n    return this._canisters[cid];\r\n  }\r\n\r\n  _makeAgent() {\r\n    var args = {};\r\n    if (this._identity) args['identity'] = this._identity;\r\n    if (this._host) args['host'] = this._host;\r\n    this._agent = new HttpAgent(args);\r\n  };\r\n};\r\n\r\nconst api = {\r\n  connect : (host, identity) => new ExtConnection(host ?? \"https://boundary.ic0.app/\", identity),\r\n};\r\nexport default api;","export const idlFactory = ({ IDL }) => {\n  const HexNeighbors = IDL.Tuple(\n    IDL.Opt(IDL.Nat),\n    IDL.Opt(IDL.Nat),\n    IDL.Opt(IDL.Nat),\n    IDL.Opt(IDL.Nat),\n    IDL.Opt(IDL.Nat),\n    IDL.Opt(IDL.Nat),\n  );\n  const BoardHex = IDL.Record({\n    'sides' : HexNeighbors,\n    'coords' : IDL.Tuple(IDL.Nat8, IDL.Nat8),\n  });\n  const Board = IDL.Record({ 'hexs' : IDL.Vec(BoardHex), 'name' : IDL.Text });\n  const BoardId = IDL.Nat32;\n  const MagniAttack = IDL.Tuple(\n    IDL.Nat8,\n    IDL.Nat8,\n    IDL.Nat8,\n    IDL.Nat8,\n    IDL.Nat8,\n  );\n  const Magni = IDL.Record({\n    'img' : IDL.Text,\n    'name' : IDL.Text,\n    'attack' : MagniAttack,\n  });\n  const MagniId = IDL.Nat32;\n  const MagniNFTId = IDL.Nat32;\n  const ItemId = IDL.Nat32;\n  const MagniNFT = IDL.Record({\n    'exp' : IDL.Nat32,\n    'magni' : MagniId,\n    'upgrades' : IDL.Vec(ItemId),\n    'transferrable' : IDL.Bool,\n  });\n  const GameHash = IDL.Text;\n  const OpponentId = IDL.Nat32;\n  const GameOption = IDL.Variant({\n    'pvp' : IDL.Tuple(BoardId, IDL.Opt(GameHash)),\n    'practice' : BoardId,\n    'opponent' : OpponentId,\n  });\n  const GameId = IDL.Nat32;\n  const GameScore = IDL.Tuple(IDL.Nat8, IDL.Nat8);\n  const GameResult = IDL.Variant({\n    'result' : IDL.Tuple(GameScore, IDL.Principal, IDL.Opt(IDL.Principal)),\n    'noresult' : IDL.Tuple(IDL.Principal, IDL.Opt(IDL.Principal), IDL.Text),\n  });\n  const GameStatus = IDL.Variant({\n    'lead' : IDL.Null,\n    'play' : IDL.Null,\n    'ended' : GameResult,\n    'lobby' : IDL.Null,\n  });\n  const GameState = IDL.Record({\n    'status' : GameStatus,\n    'moves' : IDL.Vec(IDL.Tuple(IDL.Nat, IDL.Tuple(MagniNFTId, MagniNFT))),\n    'option' : GameOption,\n    'lead' : IDL.Vec(MagniNFT),\n    'score' : GameScore,\n    'players' : IDL.Vec(IDL.Principal),\n    'isPlayer1' : IDL.Bool,\n    'board' : Board,\n  });\n  const Response = IDL.Variant({\n    'ok' : IDL.Tuple(GameId, GameState),\n    'err' : IDL.Text,\n  });\n  const Move = IDL.Record({ 'hex' : IDL.Nat, 'magni' : MagniNFTId });\n  const PlayerMove = IDL.Variant({ 'lead' : MagniNFTId, 'move' : Move });\n  const GameData = IDL.Record({\n    'magni' : IDL.Vec(IDL.Tuple(MagniId, Magni)),\n    'boards' : IDL.Vec(IDL.Tuple(BoardId, Board)),\n  });\n  return IDL.Service({\n    'addBoard' : IDL.Func([Board], [BoardId], []),\n    'addMagni' : IDL.Func([Magni], [MagniId], []),\n    'connect' : IDL.Func([], [IDL.Vec(IDL.Tuple(MagniNFTId, MagniNFT))], []),\n    'gameCreate' : IDL.Func([GameOption, IDL.Vec(MagniNFTId)], [Response], []),\n    'gameFetch' : IDL.Func([], [Response], []),\n    'gameFind' : IDL.Func([IDL.Vec(MagniNFTId)], [Response], []),\n    'gameJoin' : IDL.Func([GameHash, IDL.Vec(MagniNFTId)], [Response], []),\n    'gameLeave' : IDL.Func([GameId], [Response], []),\n    'gameMove' : IDL.Func([PlayerMove], [Response], []),\n    'gamePoll' : IDL.Func([GameId], [Response], ['query']),\n    'gameScore' : IDL.Func([GameId], [GameScore], ['query']),\n    'getAllPlayerMagnis' : IDL.Func(\n        [],\n        [IDL.Vec(IDL.Tuple(IDL.Principal, IDL.Vec(MagniNFTId)))],\n        ['query'],\n      ),\n    'getGameData' : IDL.Func([], [GameData], ['query']),\n    'getMyMagni' : IDL.Func(\n        [],\n        [IDL.Vec(IDL.Tuple(MagniNFTId, MagniNFT))],\n        ['query'],\n      ),\n    'whoami' : IDL.Func([], [IDL.Principal], ['query']),\n  });\n};\nexport const init = ({ IDL }) => { return []; };","import api from \"./extjs.js\";  \nimport * as rotmIDL from \"./rotm.did.js\";  \nimport { Ed25519KeyIdentity } from \"@dfinity/identity\";\nimport { AuthClient } from \"@dfinity/auth-client\";\nimport {Howl, Howler} from 'howler';\nimport OpenLogin from \"@toruslabs/openlogin\";\nvar AUTH, logintype;\nconst openlogin = new OpenLogin({\n  clientId: \"BHsvffJZzsm_Kb-xNOO9fGOZ2ciiMHlRjgBCeTRw18Io6OBE0QR4nd0R8AGZmL6wK9KFr9LbDeNNuj6yutSbTUA\",\n  network: \"mainnet\", // valid values (testnet or mainnet)\n  uxMode : 'popup',\n});\nshowLoader();\nfunction preload(imgs) {\n  for (var i = 0; i < imgs.length; i++) {\n    new Image().src = imgs[i];\n  }\n}\npreload(\n  [\n  \"./assets/bg.jpg\",\n  \"./assets/bgs/arena.jpg\",\n  \"./assets/bgs/lobby.jpg\",\n  \"./assets/bgs/menu.jpg\",\n  \"./assets/heros/h0.png\",\n  \"./assets/heros/h1.png\",\n  \"./assets/heros/h2.png\",\n  \"./assets/heros/h3.png\",\n  \"./assets/heros/h4.png\",\n  \"./assets/heros/h5.png\",\n  \"./assets/heros/h6.png\",\n  \"./assets/heros/h7.png\",\n  \"./assets/heros/h8.png\",\n  \"./assets/heros/h9.png\",\n  \"./assets/heros/h10.png\",\n  \"./assets/heros/h11.png\",\n  \"./assets/heros/h12.png\",\n  \"./assets/heros/h13.png\",\n  \"./assets/heros/h14.png\",\n  \"./assets/heros/h15.png\",\n  \"./assets/heros/h16.png\",\n  \"./assets/heros/h17.png\",\n  \"./assets/heros/h18.png\",\n  \"./assets/heros/h19.png\",\n  \"./assets/heros/ring0.png\",\n  \"./assets/heros/ring1.png\",\n  \"./assets/heros/ring2.png\",\n  \"./assets/heros/ring3.png\"\n  ]\n);\n\ndocument.addEventListener('DOMContentLoaded', async () => {\n  API = api.connect().idl('p5mob-qaaaa-aaaah-qaebq-cai', rotmIDL.idlFactory).canister('p5mob-qaaaa-aaaah-qaebq-cai');\n  AUTH = await AuthClient.create();\n  await openlogin.init();\n  var GD = await API.getGameData();\n  for(var i = 0; i < GD.magni.length; i++) {\n    CONFIG.magni.push([GD.magni[i][1].name].concat(GD.magni[i][1].attack));\n  };\n  for(var i = 0; i < GD.boards.length; i++) {\n    var _tb = [];\n    CONFIG.boards[GD.boards[i][1].name.toLowerCase()] = GD.boards[i][1].hexs.map(a => a.coords);\n  };\n  document.addEventListener('click', ({ offsetX, offsetY }) => {\n    if (typeof currentRoom.click != 'undefined'){\n      currentRoom.click(offsetX, offsetY);\n    }\n  });\n  hideLoader()\n  rooms.login.enter();\n});\nwindow.addEventListener(\"beforeunload\", function(e){\n   unloadROTM();\n}, false);\nwindow.onbeforeunload = unloadROTM;\nasync function unloadROTM(){\n  await ROTM.gameLeave();\n  return null;\n}\nwindow.addEventListener('blur', () => {\n  if (currentSound && !bgmuted) currentSound.mute(true);\n});\nwindow.addEventListener('focus', () => {\n  if (currentSound && !bgmuted) currentSound.mute(false);\n});\nconst updateGameState = (gs) => {\n  if (!ROTM._intv) return;\n  if (state == 'find') {\n    if (gs.status.hasOwnProperty('lead')) {\n      rooms.game.enter();\n      SOUND.alert.play();\n      ROTM._stopPolling();\n      state = 'busy';\n    };\n  }\n  if (state == 'busy') {\n    if (gs.status.hasOwnProperty('lead')) {\n      if (gameState == 1) { //We have submitted our lead\n        if (gs.lead.length == 0 || !gs.isPlayer1) {\n          //We need to resubmit ours\n          gameState = 0;\n          drawMessage(\"It was a tie - Choose another Strike Unit!\");\n          SOUND.alert.play();\n          selectedHex.unhighlight();\n          selectedHex = false;\n          ROTM._stopPolling();\n        } else {\n          //Waiting\n          //console.log(\"Waiting for opponent to choose their Strike Unit\");\n          //Keep polling\n        }\n      }\n    };\n    if (gs.status.hasOwnProperty('play')) {\n      if (gameState == 1) {\n        gameState = 2;\n        selectedHex.clear();\n        selectedHex = false;\n        if (gs.isPlayer1) {\n          currentPlayer = 1;\n          otherPlayer = 2;\n        } else {\n          otherPlayer = 1;\n          currentPlayer = 2;\n        }\n      }\n      if (gs.isPlayer1 && gs.moves.length % 2 == 0) {\n        isPlayersTurn = true;\n        ROTM._stopPolling();\n        SOUND.alert.play()\n        drawMessage(\"It is your turn now - Deploy a Magni!\");\n      } else if (!gs.isPlayer1 && gs.moves.length % 2 == 1) {\n        isPlayersTurn = true;\n        ROTM._stopPolling();\n        SOUND.alert.play()\n        drawMessage(\"It is your turn now - Deploy a Magni!\");\n      } else {\n        isPlayersTurn = false;\n      }\n    };\n    if (gs.status.hasOwnProperty('ended')) {\n      //state = 'free';\n      ROTM._stopPolling();\n      gameState = 3;\n      //console.log(gs.status.ended);\n      if (gs.status.ended.hasOwnProperty('noresult')) {\n        drawMessage(\"Game over - \"+gs.status.ended.noresult[2]+\"!\");       \n        rooms.game.backButton.show()       \n        SOUND.win.play()\n      } else if (gs.status.ended.hasOwnProperty('result')) {\n        drawMessage(\"Game over - you \"+scoreMsg()+\"!\");\n        if (scoreMsg() == \"won\") SOUND.win.play();\n        else SOUND.lose.play();\n        rooms.game.backButton.show()       \n      }\n      bgmusic();\n    };\n  };\n  if (gs.moves.length > movesMade) {\n    //console.log(\"Updating moves\");\n    for (var i = movesMade; i < gs.moves.length; i++) {\n      var p = (i%2 == 0 ? 1 : 2);\n      gamegrid[gs.moves[i][0]].isPlayerHex = (p == currentPlayer);\n      gamegrid[gs.moves[i][0]].place(p, gs.moves[i][1], (p == currentPlayer ? CONFIG.colors.ally : CONFIG.colors.enemy));\n      if (i >= 2) placeHex(gamegrid[gs.moves[i][0]]);\n    }\n    movesMade = gs.moves.length;\n  };\n  if (currentRoom == rooms.game) drawScore();\n};\n\nconst fromHexString = (hex) => {\n  if (hex.substr(0,2) === \"0x\") hex = hex.substr(2);\n  for (var bytes = [], c = 0; c < hex.length; c += 2)\n  bytes.push(parseInt(hex.substr(c, 2), 16));\n  return bytes;\n}\nconst ROTM = {\n  _gameState : false,\n  _gameId : false,\n  _intv : false,\n  _clearPolling : () => {\n    isPlayersTurn = false;\n    if (ROTM._intv) clearInterval(ROTM._intv);\n    ROTM._intv = false;\n  },\n  _stopPolling : () => {\n    if (ROTM._intv) clearInterval(ROTM._intv);\n    ROTM._intv = false;\n  },\n  _startPolling : () => {\n    ROTM._intv = setInterval(() => {\n      API.gamePoll(ROTM._gameId).then(r => {\n        //console.log(r);\n        if (r.hasOwnProperty(\"ok\")){\n          ROTM._gameState = r.ok[1];\n          updateGameState(ROTM._gameState);\n        } else {\n          console.log(r.err);\n        };\n      });\n    }, 1*1000);\n  },\n  inGame : () => {\n    if (!ROTM._gameState) return false;\n    if (ROTM._gameState.status.hasOwnProperty(\"#ended\")) return false;\n    return true;\n  },\n  /*\n  gameCreate : (roster, poll) => {\n    if (ROTM.inGame()) return;\n  },\n  gameJoin : async (roster, poll) => {\n    if (ROTM.inGame()) return;\n  },\n  */\n  gameFind : (roster, poll) => {\n    return new Promise(async (resolve, reject) => {    \n      if (ROTM.inGame()) reject(\"in game\");\n      var mids = roster.map(m => m[0]);\n      \n      API.gameFind(mids).then(resp => {\n        if (resp.hasOwnProperty('ok')) {\n          ROTM._gameId = resp.ok[0];\n          ROTM._gameState = resp.ok[1];\n          ROTM._startPolling();\n          updateGameState(ROTM._gameState);\n          resolve(ROTM._gameState);\n        } else {\n          reject(resp.err);\n        };\n      }).catch(reject);\n    });\n  },\n  gameJoin : (roster, id, poll) => {\n    return new Promise(async (resolve, reject) => {    \n      if (ROTM.inGame()) reject(\"in game\");\n      var mids = roster.map(m => m[0]);\n      \n      API.gameJoin(id, mids).then(resp => {\n        if (resp.hasOwnProperty('ok')) {\n          ROTM._gameId = resp.ok[0];\n          ROTM._gameState = resp.ok[1];\n          ROTM._startPolling();\n          updateGameState(ROTM._gameState);\n          resolve(ROTM._gameState);\n        } else {\n          reject(resp.err);\n        };\n      }).catch(reject);\n    });\n  },\n  gameCreate : (roster, id, poll) => {\n    return new Promise(async (resolve, reject) => {    \n      if (ROTM.inGame()) reject(\"in game\");\n      var mids = roster.map(m => m[0]);\n      \n      API.gameCreate({\n        pvp : [0, [id]]\n      }, mids).then(resp => {\n        if (resp.hasOwnProperty('ok')) {\n          ROTM._gameId = resp.ok[0];\n          ROTM._gameState = resp.ok[1];\n          ROTM._startPolling();\n          updateGameState(ROTM._gameState);\n          resolve(ROTM._gameState);\n        } else {\n          reject(resp.err);\n        };\n      }).catch(reject);\n    });\n  },\n  gamePractise : (roster, poll) => {\n    return new Promise(async (resolve, reject) => {    \n      if (ROTM.inGame()) reject(\"in game\");\n      var mids = roster.map(m => m[0]);\n      \n      API.gameCreate({\n        practice : 0\n      }, mids).then(resp => {\n        if (resp.hasOwnProperty('ok')) {\n          ROTM._gameId = resp.ok[0];\n          ROTM._gameState = resp.ok[1];\n          ROTM._startPolling();\n          updateGameState(ROTM._gameState);\n          resolve(ROTM._gameState);\n        } else {\n          reject(resp.err);\n        };\n      }).catch(reject);\n    });\n  },\n  gameMove : async (magni, position) => {\n    return new Promise(async (resolve, reject) => {    \n      if (position) {\n        API.gameMove({\"move\" : { hex : position, magni : magni[0] }}).then(resp => {\n          //console.log(resp);\n          if (resp.hasOwnProperty('ok')) {\n            ROTM._gameState = resp.ok[1];\n            movesMade++;\n            ROTM._startPolling();\n            updateGameState(ROTM._gameState);\n            resolve(ROTM._gameState);\n          } else {\n            reject(resp.err);\n          };\n        }).catch(reject);\n      } else {\n        API.gameMove({\"lead\" : magni[0]}).then(resp => {\n          if (resp.hasOwnProperty('ok')) {\n            ROTM._gameState = resp.ok[1];\n            ROTM._startPolling();\n            updateGameState(ROTM._gameState);\n            resolve(ROTM._gameState);\n          } else {\n            reject(resp.err);\n          };\n        }).catch(reject);   \n      }\n    });\n  },\n  gameEnd : () => {\n    ROTM._clearPolling();\n    ROTM._gameId = false;\n    ROTM._gameState = false;    \n  },\n  gameLeave : async () => {\n    ROTM._clearPolling();\n    if (ROTM._gameId) await API.gameLeave(ROTM._gameId);\n    ROTM._gameId = false;\n    ROTM._gameState = false;    \n  },\n  connect : async () => {\n    mymagni = await API.connect();\n    //console.log(mymagni);\n  },\n  stats : async () => {\n  \n  },\n  gs : () => {\n    return ROTM._gameState;\n  }\n};\n\nvar rooms = {\n  login : {\n    draw : INNERDRAW.group(),\n    enter : async () => {\n      if (currentRoom) currentRoom.exit();\n      currentRoom = rooms.login;\n      currentRoom.draw.clear();\n      \n      showLoader();\n      var id = await AUTH.getIdentity();\n      if (id.getPrincipal().toString() != '2vxsx-fae') {\n        logintype = 'ii';\n        identity = id;\n        API = api.connect(\"https://boundary.ic0.app/\",identity).idl('p5mob-qaaaa-aaaah-qaebq-cai', rotmIDL.idlFactory).canister('p5mob-qaaaa-aaaah-qaebq-cai');\n        await ROTM.connect();\n        setTimeout(() => {\n          rooms.menu.enter();\n          bgmusic('lobby');\n        }, 200);\n      };\n      if (openlogin.privKey) {\n        logintype = 'openlogin';\n        identity = Ed25519KeyIdentity.generate(new Uint8Array(fromHexString(openlogin.privKey)));\n        \n        API = api.connect(\"https://boundary.ic0.app/\",identity).idl('p5mob-qaaaa-aaaah-qaebq-cai', rotmIDL.idlFactory).canister('p5mob-qaaaa-aaaah-qaebq-cai');\n        await ROTM.connect();\n        setTimeout(() => {\n          rooms.menu.enter();\n          bgmusic('lobby');\n        }, 200);\n      }\n      hideLoader();\n      setBackground('assets/bgs/menu.jpg');\n      createButton(500,500,200,40,'Internet Identity', async () => {\n        if (!identity) {\n          showLoader();\n          AUTH.login({\n            maxTimeToLive : BigInt(24*60*60*1000000000),\n            identityProvider: \"https://identity.ic0.app/\",\n            onSuccess: async () => {\n              logintype = 'ii';\n              identity = await AUTH.getIdentity()\n              \n              API = api.connect(\"https://boundary.ic0.app/\",identity).idl('p5mob-qaaaa-aaaah-qaebq-cai', rotmIDL.idlFactory).canister('p5mob-qaaaa-aaaah-qaebq-cai');\n              await ROTM.connect()\n              hideLoader();\n              rooms.menu.enter();\n              bgmusic('lobby');\n            },\n            onError : () => {\n              hideLoader();\n              alert(\"Error logging in...\");\n            }\n          });\n        }\n      });\n      createButton(500,560,200,40,'Open Login', async () => {\n        if (!identity) {\n          showLoader();\n          await openlogin.login();\n          if (openlogin.privKey) {\n            logintype = 'openlogin';\n            identity = Ed25519KeyIdentity.generate(new Uint8Array(fromHexString(openlogin.privKey)));\n            \n            API = api.connect(\"https://boundary.ic0.app/\",identity).idl('p5mob-qaaaa-aaaah-qaebq-cai', rotmIDL.idlFactory).canister('p5mob-qaaaa-aaaah-qaebq-cai');\n            await ROTM.connect()\n            hideLoader();\n            rooms.menu.enter();\n            bgmusic('lobby');\n          } else {\n            hideLoader();\n            alert(\"Error logging in...\");\n          }\n          \n        }\n      });\n      createButton(500,680,200,40,'Help', () => {\n        window.open('https://toniqlabs.gitbook.io/rise-of-the-magni/', '_blank').focus();\n      });\n    },\n    exit : () => {\n      currentRoom.draw.clear();\n    }\n  },\n  menu : {\n    draw : INNERDRAW.group(),\n    enter : () => {\n      if (currentRoom) currentRoom.exit();\n      currentRoom = rooms.menu;\n      currentRoom.draw.clear();\n      \n      setBackground('assets/bgs/menu.jpg');\n      createButton(500,500,200,40,'Adventure', () => {\n        alert(\"Sorry, not available yet...!\");\n        //setTimeout(() => rooms.lobby.enter(0), 100);\n      });\n      createButton(500,560,200,40,'Training', () => {\n        setTimeout(() => rooms.lobby.enter(1), 100);\n      });\n      createButton(500,620,200,40,'Online', () => {\n        setTimeout(() => rooms.lobby.enter(2), 100);\n      });\n      createButton(500,680,200,40,'Settings', () => {\n        setTimeout(() => rooms.settings.enter(), 100);\n      });\n      createButton(500,740,200,40,'Logout', () => {\n        setTimeout(async () => {\n          if (logintype == 'ii') {\n            await AUTH.logout();            \n          } else {\n            await openlogin.logout();\n          };\n          identity = false;\n          API = api.connect().idl('p5mob-qaaaa-aaaah-qaebq-cai', rotmIDL.idlFactory).canister('p5mob-qaaaa-aaaah-qaebq-cai');\n          rooms.login.enter()\n        }, 100);\n      });\n    },\n    exit : () => {\n      currentRoom.draw.clear();\n    }\n  },\n  settings : {\n    draw : INNERDRAW.group(),\n    enter : () => {\n      if (currentRoom) currentRoom.exit();\n      currentRoom = rooms.settings;\n      currentRoom.draw.clear();\n      \n      setBackground('assets/bgs/menu.jpg');\n      var msfx, umsfx, mbg, umbg; \n      msfx = createButton(500,500,200,40,'Mute SFX', () => {\n        SOUND.alert.mute(true);\n        SOUND.select.mute(true);\n        SOUND.place.mute(true);\n        SOUND.lose.mute(true);\n        SOUND.win.mute(true);\n        msfx.hide();\n        umsfx.show();\n        sfxmuted = true;\n      });\n      umsfx = createButton(500,500,200,40,'Unmute SFX', () => {\n        SOUND.alert.mute(false);\n        SOUND.select.mute(false);\n        SOUND.place.mute(false);\n        SOUND.lose.mute(false);\n        SOUND.win.mute(false);\n        umsfx.hide();\n        msfx.show();\n        sfxmuted = false;\n      });\n      if (sfxmuted) msfx.hide();\n      else umsfx.hide();\n      mbg = createButton(500,560,200,40,'Mute BG Music', () => {\n        bgmuted = true;\n        currentSound.mute(true)\n        mbg.hide();\n        umbg.show();\n      });\n      umbg = createButton(500,560,200,40,'Unmute BG Music', () => {\n        bgmuted = false;\n        currentSound.mute(false)\n        mbg.show();\n        umbg.hide();\n      });\n      if (bgmuted) mbg.hide();\n      else umbg.hide();\n      createButton(500,620,200,40,'Help', () => {\n        window.open('https://toniqlabs.gitbook.io/rise-of-the-magni/', '_blank').focus();\n      });\n      createButton(500,680,200,40,'Back', () => {\n        setTimeout(() => rooms.menu.enter(), 100);\n      });\n    },\n    exit : () => {\n      currentRoom.draw.clear();\n    }\n  },\n  adventure : {\n    draw : INNERDRAW.group(),\n    chapter : false,\n    stage : false,\n    scene : false,\n    clickHandler : false,\n    inAdventureMode : false,\n    enter : (c,s) => {\n      if (currentRoom) currentRoom.exit();\n      currentRoom = rooms.adventure;\n      if (rooms.adventure.inAdventureMode) {\n        currentRoom.draw.show();\n      } else {\n        rooms.adventure.inAdventureMode = true;\n        currentRoom.draw.clear();\n        \n        rooms.adventure.scene = currentRoom.draw.group();\n        \n        rooms.adventure.chapter = 0;\n        rooms.adventure.stage = 0;\n        \n        launchAdventure(c,s);\n      }\n    },\n    exit : () => {\n      if (!rooms.adventure.inAdventureMode)\n        currentRoom.draw.clear();\n      else\n        currentRoom.draw.hide();\n    },\n    click : (offsetX, offsetY) => {\n      if (rooms.adventure.clickHandler) {\n        rooms.adventure.clickHandler();\n      }\n    }\n  },\n  lobby : {\n    headerMessage : false,\n    draw : INNERDRAW.group(),\n    hexClickHandler : (offsetX, offsetY, hex) => {\n      if (currentRoom != rooms.lobby) return;\n      if (!buttonIsFree) return;\n      buttonIsFree = false;\n      var hexCoordinates = { x : hex.x, y : hex.y };\n      //console.log(hex);\n      if (hex.type == 'hero') {\n        for(var i = 0; i < playergrid.length; i++) {\n          if (playergrid[i].magni == false) {\n            playergrid[i].isPlayerHex = true;\n            playergrid[i].set(hex.magni, CONFIG.colors.hexBg);\n            hex.removeCard();\n            SOUND.select.play();\n            updateSelectedTeam();\n            break;\n          }         \n        }\n      } else if (hex.type == 'team'){\n        if (hex.magni !== false){\n          for(var i = 0; i < herogrid.length; i++) {\n            if (herogrid[i].magni == false) {\n              herogrid[i].set(hex.magni, CONFIG.colors.hexBg);\n              break;\n            }         \n          }\n          hex.removeCard();\n          SOUND.select.play();\n          updateSelectedTeam();\n        }\n      } else if (hex.type == 'special'){\n        var magnitomove = []\n        SOUND.select.play();\n        for(var i = 0; i < playergrid.length; i++) {\n          if (playergrid[i].magni !== false) {\n            magnitomove.push(playergrid[i].magni);\n            playergrid[i].removeCard();\n          } \n        }\n        if (magnitomove.length > 0) {\n          for(var i = 0; i < herogrid.length; i++) {\n            if (herogrid[i].magni == false) {\n              herogrid[i].set(magnitomove.pop(), CONFIG.colors.hexBg);\n              if (magnitomove.length == 0) break;\n            } \n          }\n        }\n        for(var i = 0; i < herogrid.length; i++) {\n          if (CONFIG.starters[hex.magni][1].indexOf(herogrid[i].magni[1].magni) >= 0) {\n            magnitomove.push(herogrid[i].magni);\n            herogrid[i].removeCard();\n            if (magnitomove.length == 10) break;\n          }\n        };\n        for(var i = 0; i < magnitomove.length; i++) {\n          playergrid[i].isPlayerHex = true;\n          playergrid[i].set(magnitomove[i], CONFIG.colors.hexBg);\n        };\n        updateSelectedTeam();\n      }\n      drawCurrentRating();\n      buttonIsFree = true;\n    },\n    gameMode : 0,\n    enter : (gm) => {\n      if (currentRoom) currentRoom.exit();\n      currentRoom = rooms.lobby;\n      currentRoom.draw.clear();\n      if (typeof gm != 'undefined' && gm !== false) rooms.lobby.gameMode = gm;\n      setBackground('assets/bgs/lobby.jpg');\n      drawMessage(\"Select your team!\");\n      \n      //Buttons\n      var createBtn, joinBtn, playOnlineBtn, backBtn, cancelBtn;\n      if (rooms.lobby.gameMode == 0){\n        createButton(1020,10,150,40,'Start Adventure', function(){\n          if (isValidTeam()) {\n            rooms.adventure.enter(0,0);\n          } else {\n            alert(\"Please select a full team with a rating of 23 or less\");\n          }\n        });  \n      } else if (rooms.lobby.gameMode == 1){\n        createButton(1020,10,150,40,'Start Training', function(){\n          if (isValidTeam()) {\n            if (state != 'free') return;\n            showLoader();\n            ROTM.gamePractise(selectedTeam, updateGameState).then(() => {\n              rooms.game.enter();\n              SOUND.alert.play();\n              ROTM._stopPolling();\n              state = 'busy';\n            }).catch(e => {\n              state = 'free';\n              alert(e);\n            }).finally(() => {\n              hideLoader();\n            });\n          } else {\n            alert(\"Please select a full team with a rating of 23 or less\");\n          }\n        });        \n      } else if (rooms.lobby.gameMode == 2){\n        createBtn = createButton(850,10,150,40,'Create Game', () => {\n          if (isValidTeam()) {\n            if (state != 'free') return;\n            showLoader();\n            var id =  makeid(5);\n            ROTM.gameCreate(selectedTeam, id, updateGameState).then(() => {\n              state = 'find';\n              drawMessage(\"Waiting - Room code: \" + id);\n              playOnlineBtn.hide();\n              createBtn.hide();\n              joinBtn.hide();\n              backBtn.hide();\n              cancelBtn.show();\n            }).catch(e => {\n              alert(e);\n            }).finally(() => {\n              hideLoader();\n            });\n          } else {\n            alert(\"Please select a full team with a rating of 23 or less\");\n          }\n        });\n        joinBtn = createButton(850,60,150,40,'Join Game', () => {\n          if (isValidTeam()) {\n            if (state != 'free') return;\n            var id = prompt(\"Please enter room code\", \"\");\n            if (id && id.length == 5) {\n              showLoader();\n              ROTM.gameJoin(selectedTeam, id.toString(), updateGameState).then(() => {\n                state = 'find';\n                drawMessage(\"Joining game...\");\n                playOnlineBtn.hide();\n                createBtn.hide();\n                backBtn.hide();\n                cancelBtn.show();\n              }).catch(e => {\n                alert(e);\n              }).finally(() => {\n                hideLoader();\n              });\n            } else {\n              alert(\"Please ener a valid room code\");\n            }\n          } else {\n            alert(\"Please select a full team with a rating of 23 or less\");\n          }\n        });\n        playOnlineBtn = createButton(1020,10,150,40,'Match Making', () => {\n          if (isValidTeam()) {\n            if (state != 'free') return;\n            showLoader();\n            ROTM.gameFind(selectedTeam, updateGameState).then(() => {\n              state = 'find';\n              drawMessage(\"Finding a match...\");\n              playOnlineBtn.hide();\n              createBtn.hide();\n              joinBtn.hide();\n              backBtn.hide();\n              cancelBtn.show();\n            }).catch(e => {\n              alert(e);\n            }).finally(() => {\n              hideLoader();\n            });\n          } else {\n            alert(\"Please select a full team with a rating of 23 or less\");\n          }\n        });\n        cancelBtn = createButton(1020,60,150,40,'Cancel', () => {\n          showLoader();\n          ROTM.gameLeave().then(() => {\n            state = 'free';\n            drawMessage(\"Select your team!\");\n            cancelBtn.hide();\n            playOnlineBtn.show();\n            createBtn.show();\n            joinBtn.show();\n            backBtn.show();\n          }).catch(e => {\n            alert(e);\n          }).finally(() => {\n            hideLoader();\n          });\n        });\n        cancelBtn.hide();\n        \n      }\n      \n      backBtn = createButton(1020,60,150,40,'Back', function(){\n        rooms.menu.enter();\n      });  \n      \n      selectedHex = false;\n      state = 'free';\n      herogrid.map((hex, i) => {\n        hex.init('hero', currentRoom.draw.group());\n        if (i < mymagni.length) {\n          if (selectedTeam.indexOf(mymagni[i]) < 0) hex.set(mymagni[i], CONFIG.colors.hexBg);\n        }\n      });\n      playergrid.map((hex, i) => {\n        hex.isPlayerHex = true;\n        hex.init('team', currentRoom.draw.group());\n        if (selectedTeam.length > i)\n          hex.set(selectedTeam[i], CONFIG.colors.hexBg);\n      });\n      premadegrid.map((hex, i) => {\n        hex.init('special', currentRoom.draw.group());\n        hex.special(CONFIG.starters[i][0], i);\n      });\n      drawCurrentRating()\n    },\n    click : (offsetX, offsetY) => {\n\n    },\n    exit : () => {\n      currentRoom.draw.clear();\n      currentRoom.headerMessage = false;\n      omd = false;\n      rd = false;\n    }\n  },\n  game : {\n    headerMessage : false,\n    draw : INNERDRAW.group(),\n    hexClickHandler : (offsetX, offsetY, hex) => {\n      if (gameState == 3) return;\n      var hexCoordinates = { x : hex.x, y : hex.y };\n      if (gameState == 0){\n        if (hex.type == 'team') {\n          selectedHex = hex;\n          selectedHex.highlight(CONFIG.colors.ally)\n          gameState = 1;\n          drawMessage(\"Waiting for other player...\");\n          ROTM.gameMove(selectedHex.magni);\n          SOUND.select.play();\n        }\n      } else if (gameState == 2){\n        if (isPlayersTurn){\n          if (hex.type == 'game') {\n            if (hex.player == 0){\n              if (selectedHex) {\n                ROTM.gameMove(selectedHex.magni, hex.index);\n                hex.isPlayerHex = true;\n                isPlayersTurn = false;\n                hex.place(currentPlayer, selectedHex.magni, CONFIG.colors.ally);\n                SOUND.place.play();\n                placeHex(hex, true);\n                selectedHex.clear();\n                drawMessage(\"Waiting for other player...\");\n              }\n            }\n          }\n          if (hex.type == 'team' && hex.magni !== false) {\n            if (selectedHex) selectedHex.unhighlight();\n            hex.highlight(CONFIG.colors.ally)\n            selectedHex = hex;\n            SOUND.select.play();\n          }\n        }\n      }\n    },\n    character : false,\n    board : false,\n    result : 0,\n    playerScore : 0,\n    opponentScore : 0,\n    enter : (bbt, bbfn, board, character) => {\n      if (currentRoom) currentRoom.exit();\n      currentRoom = rooms.game;\n      currentRoom.draw.clear();\n      localScore = [0,0];\n      bgmusic('battle');\n      setBackground('assets/bgs/arena.jpg');\n      selectedHex = false;\n      gameState = 0;\n      movesMade = 0;\n      if (character) rooms.game.character = character;\n      if (!bbt) bbt = \"Back\";\n      if (!bbfn) bbfn = (r) => {    \n        bgmusic('lobby');\n        ROTM.gameEnd();\n        rooms.lobby.enter()\n      };\n      if (!board) board = CONFIG.boards.standard;\n      gamegrid = Grid(board);\n      rooms.game.board = board;\n      rooms.game.backButton = createButton(1020,10,150,40, bbt, () => {\n        bbfn(rooms.game.result);\n      });\n      rooms.game.backButton.hide();\n      \n      //Draw game grid\n      gamegrid.map((hex, i) => {\n        hex.index = i;\n        hex.magni = false;\n        hex.player = 0;\n        hex.init('game', currentRoom.draw.group());\n      });\n      var c = 0;\n      playergrid.map(hex => {\n        hex.isPlayerHex = true;\n        hex.init('team', currentRoom.draw.group());\n        hex.set(selectedTeam[c++], CONFIG.colors.hexBg);\n      });\n      \n      //Reset variables\n      drawMessage(\"Game found - Select your Strike Unit\");\n    },\n    exit : () => {\n      currentRoom.draw.clear();\n      currentRoom.headerMessage = false;\n      st1 = false;\n      st2 = false;\n      omd = false;\n    }\n  }\n}\nwindow.rooms = rooms;\nwindow.ROTM = ROTM;\n\n\nwindow.SOUND = {\n  alert : new Howl({src: ['assets/sounds/alert.mp3']}),\n  battle : new Howl({src: ['assets/sounds/battle.wav']}),\n  lobby : new Howl({src: ['assets/sounds/lobby.wav']}),\n  lose : new Howl({src: ['assets/sounds/lose.wav']}),\n  place : new Howl({src: ['assets/sounds/place.wav']}),\n  select : new Howl({src: ['assets/sounds/select.mp3']}),\n  win : new Howl({src: ['assets/sounds/win.mp3']}),\n};\nSOUND.battle.volume(0.5);\nSOUND.alert.volume(0.2);\nSOUND.select.volume(0.4);\nSOUND.place.volume(0.1);\nSOUND.lose.volume(0.1);\nSOUND.win.volume(0.1);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdO = {};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t296: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) var result = runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkrotm_v2\"] = self[\"webpackChunkrotm_v2\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [38], () => (__webpack_require__(5872)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"sourceRoot":""}