{"version":3,"sources":["webpack://rotm_v2/webpack/runtime/chunk loaded","webpack://rotm_v2/./src/extjs.js","webpack://rotm_v2/./src/rotm.did.js","webpack://rotm_v2/./src/main.js","webpack://rotm_v2/webpack/bootstrap","webpack://rotm_v2/webpack/runtime/amd options","webpack://rotm_v2/webpack/runtime/compat get default export","webpack://rotm_v2/webpack/runtime/define property getters","webpack://rotm_v2/webpack/runtime/global","webpack://rotm_v2/webpack/runtime/hasOwnProperty shorthand","webpack://rotm_v2/webpack/runtime/make namespace object","webpack://rotm_v2/webpack/runtime/node module decorator","webpack://rotm_v2/webpack/runtime/jsonp chunk loading","webpack://rotm_v2/webpack/startup"],"names":["deferred","_preloadedIdls","ExtConnection","_mapIdls","_identity","_host","_agent","_canisters","constructor","host","identity","this","_makeAgent","idl","canister","setIdentity","setHost","cid","hasOwnProperty","Error","agent","canisterId","args","idlFactory","IDL","HexNeighbors","Tuple","Opt","Nat","BoardHex","Record","Nat8","Board","Vec","Text","BoardId","Nat32","MagniAttack","Magni","MagniId","MagniNFTId","ItemId","MagniNFT","Bool","GameHash","OpponentId","GameOption","Variant","GameId","GameScore","GameResult","Principal","GameStatus","Null","GameState","Response","Move","PlayerMove","GameData","Service","Func","AUTH","logintype","openlogin","clientId","network","uxMode","unloadROTM","ROTM","_gameId","gameLeave","showLoader","imgs","i","length","Image","src","preload","document","addEventListener","async","API","init","GD","getGameData","magni","CONFIG","push","name","concat","attack","boards","toLowerCase","hexs","map","a","coords","offsetX","offsetY","currentRoom","click","hideLoader","rooms","login","enter","window","e","onbeforeunload","currentSound","bgmuted","mute","updateGameState","gs","_intv","state","status","game","SOUND","alert","play","_stopPolling","gameState","lead","isPlayer1","drawMessage","selectedHex","unhighlight","clear","currentPlayer","otherPlayer","moves","isPlayersTurn","updateMagni","then","r","ended","noresult","backButton","show","win","scoreMsg","lose","bgmusic","movesMade","p","gamegrid","isPlayerHex","place","colors","ally","enemy","placeHex","drawScore","fromHexString","hex","substr","bytes","c","parseInt","_gameState","_clearPolling","clearInterval","_startPolling","setInterval","gamePoll","ok","console","log","err","inGame","gameFind","roster","poll","Promise","resolve","reject","mids","m","resp","catch","gameJoin","id","gameCreate","pvp","gamePractise","practice","gameMove","position","gameEnd","connect","mymagni","reward","newmagni","find","o","stats","draw","INNERDRAW","group","exit","getIdentity","getPrincipal","toString","setTimeout","menu","privKey","Uint8Array","setBackground","createButton","maxTimeToLive","BigInt","identityProvider","onSuccess","onError","open","focus","lobby","settings","logout","msfx","umsfx","mbg","umbg","select","hide","sfxmuted","adventure","chapter","stage","scene","clickHandler","inAdventureMode","s","launchAdventure","headerMessage","hexClickHandler","buttonIsFree","x","y","type","playergrid","set","hexBg","removeCard","updateSelectedTeam","herogrid","magnitomove","pop","starters","indexOf","drawCurrentRating","gameMode","gm","createBtn","joinBtn","playOnlineBtn","backBtn","cancelBtn","isValidTeam","selectedTeam","finally","makeid","prompt","premadegrid","special","omd","rd","highlight","player","index","character","board","result","playerScore","opponentScore","bbt","bbfn","localScore","standard","Grid","st1","st2","Howl","battle","volume","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","loaded","__webpack_modules__","call","amdO","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","Object","keys","every","key","splice","n","getter","__esModule","d","definition","defineProperty","enumerable","get","g","globalThis","Function","obj","prop","prototype","Symbol","toStringTag","value","nmd","paths","children","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","data","moreModules","runtime","chunkLoadingGlobal","self","forEach","bind","__webpack_exports__"],"mappings":"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","file":"bundle.js","sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","/* global BigInt */\r\nimport { Actor, HttpAgent } from \"@dfinity/agent\";  \r\n\r\n//Preload IDLS against a common name\r\nconst _preloadedIdls = {\r\n\r\n};\r\n\r\nclass ExtConnection {\r\n  _mapIdls = {\r\n  };\r\n\r\n  _identity = false;\r\n  _host = false;\r\n  _agent = false;\r\n  _canisters = {};\r\n  \r\n  constructor(host, identity) {\r\n    if (identity) this._identity = identity;\r\n    if (host) this._host = host;\r\n    this._makeAgent();\r\n  }\r\n  idl(canister, idl) {\r\n    this._mapIdls[canister] = idl;\r\n    return this;\r\n  };\r\n  setIdentity(identity) {\r\n    if (identity) this._identity = identity;\r\n    else this._identity = false;\r\n    this._makeAgent();\r\n    return this;\r\n  }\r\n  setHost(host) {\r\n    if (host) this._host = host;\r\n    else this._host = false;\r\n    this._makeAgent();\r\n    return this;\r\n  }\r\n  canister(cid, idl) {\r\n    if (!idl){\r\n      if (this._mapIdls.hasOwnProperty(cid)) {\r\n        idl = this._mapIdls[cid];\r\n      } else {\r\n        throw new Error(idl + \" is not a preloaded IDL\");\r\n      }\r\n    } else if (typeof idl == 'string') {\r\n      if (_preloadedIdls.hasOwnProperty(idl)) {\r\n        idl = _preloadedIdls[idl];\r\n      } else {\r\n        throw new Error(idl + \" is not a preloaded IDL\");\r\n      }\r\n    }\r\n    if (!this._canisters.hasOwnProperty(cid)){\r\n      this._canisters[cid] = Actor.createActor(idl, {agent : this._agent, canisterId : cid});\r\n    }\r\n    return this._canisters[cid];\r\n  }\r\n\r\n  _makeAgent() {\r\n    var args = {};\r\n    if (this._identity) args['identity'] = this._identity;\r\n    if (this._host) args['host'] = this._host;\r\n    this._agent = new HttpAgent(args);\r\n  };\r\n};\r\n\r\nconst api = {\r\n  connect : (host, identity) => new ExtConnection(host ?? \"https://boundary.ic0.app/\", identity),\r\n};\r\nexport default api;","export const idlFactory = ({ IDL }) => {\n  const HexNeighbors = IDL.Tuple(\n    IDL.Opt(IDL.Nat),\n    IDL.Opt(IDL.Nat),\n    IDL.Opt(IDL.Nat),\n    IDL.Opt(IDL.Nat),\n    IDL.Opt(IDL.Nat),\n    IDL.Opt(IDL.Nat),\n  );\n  const BoardHex = IDL.Record({\n    'sides' : HexNeighbors,\n    'coords' : IDL.Tuple(IDL.Nat8, IDL.Nat8),\n  });\n  const Board = IDL.Record({ 'hexs' : IDL.Vec(BoardHex), 'name' : IDL.Text });\n  const BoardId = IDL.Nat32;\n  const MagniAttack = IDL.Tuple(\n    IDL.Nat8,\n    IDL.Nat8,\n    IDL.Nat8,\n    IDL.Nat8,\n    IDL.Nat8,\n  );\n  const Magni = IDL.Record({\n    'img' : IDL.Text,\n    'name' : IDL.Text,\n    'attack' : MagniAttack,\n  });\n  const MagniId = IDL.Nat32;\n  const MagniNFTId = IDL.Nat32;\n  const ItemId = IDL.Nat32;\n  const MagniNFT = IDL.Record({\n    'exp' : IDL.Nat32,\n    'magni' : MagniId,\n    'upgrades' : IDL.Vec(ItemId),\n    'transferrable' : IDL.Bool,\n  });\n  const GameHash = IDL.Text;\n  const OpponentId = IDL.Nat32;\n  const GameOption = IDL.Variant({\n    'pvp' : IDL.Tuple(BoardId, IDL.Opt(GameHash)),\n    'practice' : BoardId,\n    'opponent' : OpponentId,\n  });\n  const GameId = IDL.Nat32;\n  const GameScore = IDL.Tuple(IDL.Nat8, IDL.Nat8);\n  const GameResult = IDL.Variant({\n    'result' : IDL.Tuple(GameScore, IDL.Principal, IDL.Opt(IDL.Principal)),\n    'noresult' : IDL.Tuple(IDL.Principal, IDL.Opt(IDL.Principal), IDL.Text),\n  });\n  const GameStatus = IDL.Variant({\n    'lead' : IDL.Null,\n    'play' : IDL.Null,\n    'ended' : GameResult,\n    'lobby' : IDL.Null,\n  });\n  const GameState = IDL.Record({\n    'status' : GameStatus,\n    'moves' : IDL.Vec(IDL.Tuple(IDL.Nat, IDL.Tuple(MagniNFTId, MagniNFT))),\n    'option' : GameOption,\n    'lead' : IDL.Vec(MagniNFT),\n    'score' : GameScore,\n    'players' : IDL.Vec(IDL.Principal),\n    'isPlayer1' : IDL.Bool,\n    'board' : Board,\n  });\n  const Response = IDL.Variant({\n    'ok' : IDL.Tuple(GameId, GameState),\n    'err' : IDL.Text,\n  });\n  const Move = IDL.Record({ 'hex' : IDL.Nat, 'magni' : MagniNFTId });\n  const PlayerMove = IDL.Variant({ 'lead' : MagniNFTId, 'move' : Move });\n  const GameData = IDL.Record({\n    'magni' : IDL.Vec(IDL.Tuple(MagniId, Magni)),\n    'boards' : IDL.Vec(IDL.Tuple(BoardId, Board)),\n  });\n  return IDL.Service({\n    'addBoard' : IDL.Func([Board], [BoardId], []),\n    'addMagni' : IDL.Func([Magni], [MagniId], []),\n    'connect' : IDL.Func([], [IDL.Vec(IDL.Tuple(MagniNFTId, MagniNFT))], []),\n    'gameCreate' : IDL.Func([GameOption, IDL.Vec(MagniNFTId)], [Response], []),\n    'gameFetch' : IDL.Func([], [Response], []),\n    'gameFind' : IDL.Func([IDL.Vec(MagniNFTId)], [Response], []),\n    'gameJoin' : IDL.Func([GameHash, IDL.Vec(MagniNFTId)], [Response], []),\n    'gameLeave' : IDL.Func([GameId], [Response], []),\n    'gameMove' : IDL.Func([PlayerMove], [Response], []),\n    'gamePoll' : IDL.Func([GameId], [Response], ['query']),\n    'gameScore' : IDL.Func([GameId], [GameScore], ['query']),\n    'getAllPlayerMagnis' : IDL.Func(\n        [],\n        [IDL.Vec(IDL.Tuple(IDL.Principal, IDL.Vec(MagniNFTId)))],\n        ['query'],\n      ),\n    'getGameData' : IDL.Func([], [GameData], ['query']),\n    'getMyMagni' : IDL.Func(\n        [],\n        [IDL.Vec(IDL.Tuple(MagniNFTId, MagniNFT))],\n        ['query'],\n      ),\n    'whoami' : IDL.Func([], [IDL.Principal], ['query']),\n  });\n};\nexport const init = ({ IDL }) => { return []; };","import api from \"./extjs.js\";  \nimport * as rotmIDL from \"./rotm.did.js\";  \nimport { Ed25519KeyIdentity } from \"@dfinity/identity\";\nimport { AuthClient } from \"@dfinity/auth-client\";\nimport {Howl, Howler} from 'howler';\nimport OpenLogin from \"@toruslabs/openlogin\";\nvar AUTH, logintype;\nconst openlogin = new OpenLogin({\n  clientId: \"BHsvffJZzsm_Kb-xNOO9fGOZ2ciiMHlRjgBCeTRw18Io6OBE0QR4nd0R8AGZmL6wK9KFr9LbDeNNuj6yutSbTUA\",\n  network: \"mainnet\", // valid values (testnet or mainnet)\n  uxMode : 'popup',\n});\nshowLoader();\nfunction preload(imgs) {\n  for (var i = 0; i < imgs.length; i++) {\n    new Image().src = imgs[i];\n  }\n}\npreload(\n  [\n  \"./assets/bg.jpg\",\n  \"./assets/bgs/arena.jpg\",\n  \"./assets/bgs/lobby.jpg\",\n  \"./assets/bgs/menu.jpg\",\n  \"./assets/heros/h0.png\",\n  \"./assets/heros/h1.png\",\n  \"./assets/heros/h2.png\",\n  \"./assets/heros/h3.png\",\n  \"./assets/heros/h4.png\",\n  \"./assets/heros/h5.png\",\n  \"./assets/heros/h6.png\",\n  \"./assets/heros/h7.png\",\n  \"./assets/heros/h8.png\",\n  \"./assets/heros/h9.png\",\n  \"./assets/heros/h10.png\",\n  \"./assets/heros/h11.png\",\n  \"./assets/heros/h12.png\",\n  \"./assets/heros/h13.png\",\n  \"./assets/heros/h14.png\",\n  \"./assets/heros/h15.png\",\n  \"./assets/heros/h16.png\",\n  \"./assets/heros/h17.png\",\n  \"./assets/heros/h18.png\",\n  \"./assets/heros/h19.png\",\n  \"./assets/heros/ring0.png\",\n  \"./assets/heros/ring1.png\",\n  \"./assets/heros/ring2.png\",\n  \"./assets/heros/ring3.png\"\n  ]\n);\n\ndocument.addEventListener('DOMContentLoaded', async () => {\n  API = api.connect().idl('p5mob-qaaaa-aaaah-qaebq-cai', rotmIDL.idlFactory).canister('p5mob-qaaaa-aaaah-qaebq-cai');\n  AUTH = await AuthClient.create();\n  await openlogin.init();\n  var GD = await API.getGameData();\n  for(var i = 0; i < GD.magni.length; i++) {\n    CONFIG.magni.push([GD.magni[i][1].name].concat(GD.magni[i][1].attack));\n  };\n  for(var i = 0; i < GD.boards.length; i++) {\n    var _tb = [];\n    CONFIG.boards[GD.boards[i][1].name.toLowerCase()] = GD.boards[i][1].hexs.map(a => a.coords);\n  };\n  document.addEventListener('click', ({ offsetX, offsetY }) => {\n    if (typeof currentRoom.click != 'undefined'){\n      currentRoom.click(offsetX, offsetY);\n    }\n  });\n  hideLoader()\n  rooms.login.enter();\n});\nwindow.addEventListener(\"beforeunload\", function(e){\n   unloadROTM();\n}, false);\nwindow.onbeforeunload = unloadROTM;\nfunction unloadROTM(){\n  if (ROTM._gameId) {\n    return ROTM.gameLeave();\n  }\n  return null;\n}\nwindow.addEventListener('blur', () => {\n  if (currentSound && !bgmuted) currentSound.mute(true);\n});\nwindow.addEventListener('focus', () => {\n  if (currentSound && !bgmuted) currentSound.mute(false);\n});\nconst updateGameState = (gs) => {\n  if (!ROTM._intv) return;\n  if (state == 'find') {\n    if (gs.status.hasOwnProperty('lead')) {\n      rooms.game.enter();\n      SOUND.alert.play();\n      ROTM._stopPolling();\n      state = 'busy';\n    };\n  }\n  if (state == 'busy') {\n    if (gs.status.hasOwnProperty('lead')) {\n      if (gameState == 1) { //We have submitted our lead\n        if (gs.lead.length == 0 || !gs.isPlayer1) {\n          //We need to resubmit ours\n          gameState = 0;\n          drawMessage(\"It was a tie - Choose another Strike Unit!\");\n          SOUND.alert.play();\n          selectedHex.unhighlight();\n          selectedHex = false;\n          ROTM._stopPolling();\n        } else {\n          //Waiting\n          //console.log(\"Waiting for opponent to choose their Strike Unit\");\n          //Keep polling\n        }\n      }\n    };\n    if (gs.status.hasOwnProperty('play')) {\n      if (gameState == 1) {\n        gameState = 2;\n        selectedHex.clear();\n        selectedHex = false;\n        if (gs.isPlayer1) {\n          currentPlayer = 1;\n          otherPlayer = 2;\n        } else {\n          otherPlayer = 1;\n          currentPlayer = 2;\n        }\n      }\n      if (gs.isPlayer1 && gs.moves.length % 2 == 0) {\n        isPlayersTurn = true;\n        ROTM._stopPolling();\n        SOUND.alert.play()\n        drawMessage(\"It is your turn now - Deploy a Magni!\");\n      } else if (!gs.isPlayer1 && gs.moves.length % 2 == 1) {\n        isPlayersTurn = true;\n        ROTM._stopPolling();\n        SOUND.alert.play()\n        drawMessage(\"It is your turn now - Deploy a Magni!\");\n      } else {\n        isPlayersTurn = false;\n      }\n    };\n    if (gs.status.hasOwnProperty('ended')) {\n      //state = 'free';\n      ROTM._stopPolling();\n      showLoader();\n      ROTM.updateMagni().then(r => {\n        hideLoader();\n        if (r) {\n          alert(\"You have unlocked a new Magni!\");\n        }\n        gameState = 3;\n        if (gs.status.ended.hasOwnProperty('noresult')) {\n          drawMessage(\"Game over - \"+gs.status.ended.noresult[2]+\"!\");       \n          rooms.game.backButton.show()       \n          SOUND.win.play()\n        } else if (gs.status.ended.hasOwnProperty('result')) {\n          drawMessage(\"Game over - you \"+scoreMsg()+\"!\");\n          if (scoreMsg() == \"won\") SOUND.win.play();\n          else SOUND.lose.play();\n          rooms.game.backButton.show()       \n        }\n        bgmusic();\n      });\n    };\n  };\n  if (gs.moves.length > movesMade) {\n    //console.log(\"Updating moves\");\n    for (var i = movesMade; i < gs.moves.length; i++) {\n      var p = (i%2 == 0 ? 1 : 2);\n      gamegrid[gs.moves[i][0]].isPlayerHex = (p == currentPlayer);\n      gamegrid[gs.moves[i][0]].place(p, gs.moves[i][1], (p == currentPlayer ? CONFIG.colors.ally : CONFIG.colors.enemy));\n      if (i >= 2) placeHex(gamegrid[gs.moves[i][0]]);\n    }\n    movesMade = gs.moves.length;\n  };\n  if (currentRoom == rooms.game) drawScore();\n};\n\nconst fromHexString = (hex) => {\n  if (hex.substr(0,2) === \"0x\") hex = hex.substr(2);\n  for (var bytes = [], c = 0; c < hex.length; c += 2)\n  bytes.push(parseInt(hex.substr(c, 2), 16));\n  return bytes;\n}\nconst ROTM = {\n  _gameState : false,\n  _gameId : false,\n  _intv : false,\n  _clearPolling : () => {\n    isPlayersTurn = false;\n    if (ROTM._intv) clearInterval(ROTM._intv);\n    ROTM._intv = false;\n  },\n  _stopPolling : () => {\n    if (ROTM._intv) clearInterval(ROTM._intv);\n    ROTM._intv = false;\n  },\n  _startPolling : () => {\n    ROTM._intv = setInterval(() => {\n      API.gamePoll(ROTM._gameId).then(r => {\n        //console.log(r);\n        if (r.hasOwnProperty(\"ok\")){\n          ROTM._gameState = r.ok[1];\n          updateGameState(ROTM._gameState);\n        } else {\n          console.log(r.err);\n        };\n      });\n    }, 1*1000);\n  },\n  inGame : () => {\n    if (!ROTM._gameState) return false;\n    if (ROTM._gameState.status.hasOwnProperty(\"#ended\")) return false;\n    return true;\n  },\n  /*\n  gameCreate : (roster, poll) => {\n    if (ROTM.inGame()) return;\n  },\n  gameJoin : async (roster, poll) => {\n    if (ROTM.inGame()) return;\n  },\n  */\n  gameFind : (roster, poll) => {\n    return new Promise(async (resolve, reject) => {    \n      if (ROTM.inGame()) reject(\"in game\");\n      var mids = roster.map(m => m[0]);\n      \n      API.gameFind(mids).then(resp => {\n        if (resp.hasOwnProperty('ok')) {\n          ROTM._gameId = resp.ok[0];\n          ROTM._gameState = resp.ok[1];\n          ROTM._startPolling();\n          updateGameState(ROTM._gameState);\n          resolve(ROTM._gameState);\n        } else {\n          reject(resp.err);\n        };\n      }).catch(reject);\n    });\n  },\n  gameJoin : (roster, id, poll) => {\n    return new Promise(async (resolve, reject) => {    \n      if (ROTM.inGame()) reject(\"in game\");\n      var mids = roster.map(m => m[0]);\n      \n      API.gameJoin(id, mids).then(resp => {\n        if (resp.hasOwnProperty('ok')) {\n          ROTM._gameId = resp.ok[0];\n          ROTM._gameState = resp.ok[1];\n          ROTM._startPolling();\n          updateGameState(ROTM._gameState);\n          resolve(ROTM._gameState);\n        } else {\n          reject(resp.err);\n        };\n      }).catch(reject);\n    });\n  },\n  gameCreate : (roster, id, poll) => {\n    return new Promise(async (resolve, reject) => {    \n      if (ROTM.inGame()) reject(\"in game\");\n      var mids = roster.map(m => m[0]);\n      \n      API.gameCreate({\n        pvp : [0, [id]]\n      }, mids).then(resp => {\n        if (resp.hasOwnProperty('ok')) {\n          ROTM._gameId = resp.ok[0];\n          ROTM._gameState = resp.ok[1];\n          ROTM._startPolling();\n          updateGameState(ROTM._gameState);\n          resolve(ROTM._gameState);\n        } else {\n          reject(resp.err);\n        };\n      }).catch(reject);\n    });\n  },\n  gamePractise : (roster, poll) => {\n    return new Promise(async (resolve, reject) => {    \n      if (ROTM.inGame()) reject(\"in game\");\n      var mids = roster.map(m => m[0]);\n      \n      API.gameCreate({\n        practice : 0\n      }, mids).then(resp => {\n        if (resp.hasOwnProperty('ok')) {\n          ROTM._gameId = resp.ok[0];\n          ROTM._gameState = resp.ok[1];\n          ROTM._startPolling();\n          updateGameState(ROTM._gameState);\n          resolve(ROTM._gameState);\n        } else {\n          reject(resp.err);\n        };\n      }).catch(reject);\n    });\n  },\n  gameMove : async (magni, position) => {\n    return new Promise(async (resolve, reject) => {    \n      if (position) {\n        API.gameMove({\"move\" : { hex : position, magni : magni[0] }}).then(resp => {\n          //console.log(resp);\n          if (resp.hasOwnProperty('ok')) {\n            ROTM._gameState = resp.ok[1];\n            movesMade++;\n            ROTM._startPolling();\n            updateGameState(ROTM._gameState);\n            resolve(ROTM._gameState);\n          } else {\n            reject(resp.err);\n          };\n        }).catch(reject);\n      } else {\n        API.gameMove({\"lead\" : magni[0]}).then(resp => {\n          if (resp.hasOwnProperty('ok')) {\n            ROTM._gameState = resp.ok[1];\n            ROTM._startPolling();\n            updateGameState(ROTM._gameState);\n            resolve(ROTM._gameState);\n          } else {\n            reject(resp.err);\n          };\n        }).catch(reject);   \n      }\n    });\n  },\n  gameEnd : () => {\n    ROTM._clearPolling();\n    ROTM._gameId = false;\n    ROTM._gameState = false;    \n  },\n  gameLeave : async () => {\n    ROTM._clearPolling();\n    if (ROTM._gameId) await API.gameLeave(ROTM._gameId);\n    ROTM._gameId = false;\n    ROTM._gameState = false;    \n  },\n  connect : async () => {\n    mymagni = await API.connect();\n  },\n  updateMagni : async () => {\n    var reward = false;\n    var newmagni = await API.connect();\n    for(var i = 0; i < newmagni.length; i++) {\n      let m = mymagni.find(o => o[0] == newmagni[i][0]);\n      if (!m) {\n        mymagni.push(newmagni[i]);\n        reward = true;\n      }\n    };\n    return reward;\n  },\n  stats : async () => {\n  \n  },\n  gs : () => {\n    return ROTM._gameState;\n  }\n};\n\nvar rooms = {\n  login : {\n    draw : INNERDRAW.group(),\n    enter : async () => {\n      if (currentRoom) currentRoom.exit();\n      currentRoom = rooms.login;\n      currentRoom.draw.clear();\n      \n      showLoader();\n      var id = await AUTH.getIdentity();\n      if (id.getPrincipal().toString() != '2vxsx-fae') {\n        logintype = 'ii';\n        identity = id;\n        API = api.connect(\"https://boundary.ic0.app/\",identity).idl('p5mob-qaaaa-aaaah-qaebq-cai', rotmIDL.idlFactory).canister('p5mob-qaaaa-aaaah-qaebq-cai');\n        await ROTM.connect();\n        setTimeout(() => {\n          rooms.menu.enter();\n          bgmusic('lobby');\n        }, 200);\n      };\n      if (openlogin.privKey) {\n        logintype = 'openlogin';\n        identity = Ed25519KeyIdentity.generate(new Uint8Array(fromHexString(openlogin.privKey)));\n        \n        API = api.connect(\"https://boundary.ic0.app/\",identity).idl('p5mob-qaaaa-aaaah-qaebq-cai', rotmIDL.idlFactory).canister('p5mob-qaaaa-aaaah-qaebq-cai');\n        await ROTM.connect();\n        setTimeout(() => {\n          rooms.menu.enter();\n          bgmusic('lobby');\n        }, 200);\n      }\n      hideLoader();\n      setBackground('assets/bgs/menu.jpg');\n      createButton(500,500,200,40,'Internet Identity', async () => {\n        if (!identity) {\n          showLoader();\n          AUTH.login({\n            maxTimeToLive : BigInt(24*60*60*1000000000),\n            identityProvider: \"https://identity.ic0.app/\",\n            onSuccess: async () => {\n              logintype = 'ii';\n              identity = await AUTH.getIdentity()\n              \n              API = api.connect(\"https://boundary.ic0.app/\",identity).idl('p5mob-qaaaa-aaaah-qaebq-cai', rotmIDL.idlFactory).canister('p5mob-qaaaa-aaaah-qaebq-cai');\n              await ROTM.connect()\n              hideLoader();\n              rooms.menu.enter();\n              bgmusic('lobby');\n            },\n            onError : () => {\n              hideLoader();\n              alert(\"Error logging in...\");\n            }\n          });\n        }\n      });\n      createButton(500,560,200,40,'Open Login', async () => {\n        if (!identity) {\n          showLoader();\n          await openlogin.login();\n          if (openlogin.privKey) {\n            logintype = 'openlogin';\n            identity = Ed25519KeyIdentity.generate(new Uint8Array(fromHexString(openlogin.privKey)));\n            \n            API = api.connect(\"https://boundary.ic0.app/\",identity).idl('p5mob-qaaaa-aaaah-qaebq-cai', rotmIDL.idlFactory).canister('p5mob-qaaaa-aaaah-qaebq-cai');\n            await ROTM.connect()\n            hideLoader();\n            rooms.menu.enter();\n            bgmusic('lobby');\n          } else {\n            hideLoader();\n            alert(\"Error logging in...\");\n          }\n          \n        }\n      });\n      createButton(500,680,200,40,'Help', () => {\n        window.open('https://toniqlabs.gitbook.io/rise-of-the-magni/', '_blank').focus();\n      });\n    },\n    exit : () => {\n      currentRoom.draw.clear();\n    }\n  },\n  menu : {\n    draw : INNERDRAW.group(),\n    enter : () => {\n      if (currentRoom) currentRoom.exit();\n      currentRoom = rooms.menu;\n      currentRoom.draw.clear();\n      \n      setBackground('assets/bgs/menu.jpg');\n      createButton(500,500,200,40,'Adventure', () => {\n        alert(\"Sorry, not available yet...!\");\n        //setTimeout(() => rooms.lobby.enter(0), 100);\n      });\n      createButton(500,560,200,40,'Training', () => {\n        setTimeout(() => rooms.lobby.enter(1), 100);\n      });\n      createButton(500,620,200,40,'Online', () => {\n        setTimeout(() => rooms.lobby.enter(2), 100);\n      });\n      createButton(500,680,200,40,'Settings', () => {\n        setTimeout(() => rooms.settings.enter(), 100);\n      });\n      createButton(500,740,200,40,'Logout', () => {\n        setTimeout(async () => {\n          if (logintype == 'ii') {\n            await AUTH.logout();            \n          } else {\n            await openlogin.logout();\n          };\n          identity = false;\n          API = api.connect().idl('p5mob-qaaaa-aaaah-qaebq-cai', rotmIDL.idlFactory).canister('p5mob-qaaaa-aaaah-qaebq-cai');\n          rooms.login.enter()\n        }, 100);\n      });\n    },\n    exit : () => {\n      currentRoom.draw.clear();\n    }\n  },\n  settings : {\n    draw : INNERDRAW.group(),\n    enter : () => {\n      if (currentRoom) currentRoom.exit();\n      currentRoom = rooms.settings;\n      currentRoom.draw.clear();\n      \n      setBackground('assets/bgs/menu.jpg');\n      var msfx, umsfx, mbg, umbg; \n      msfx = createButton(500,500,200,40,'Mute SFX', () => {\n        SOUND.alert.mute(true);\n        SOUND.select.mute(true);\n        SOUND.place.mute(true);\n        SOUND.lose.mute(true);\n        SOUND.win.mute(true);\n        msfx.hide();\n        umsfx.show();\n        sfxmuted = true;\n      });\n      umsfx = createButton(500,500,200,40,'Unmute SFX', () => {\n        SOUND.alert.mute(false);\n        SOUND.select.mute(false);\n        SOUND.place.mute(false);\n        SOUND.lose.mute(false);\n        SOUND.win.mute(false);\n        umsfx.hide();\n        msfx.show();\n        sfxmuted = false;\n      });\n      if (sfxmuted) msfx.hide();\n      else umsfx.hide();\n      mbg = createButton(500,560,200,40,'Mute BG Music', () => {\n        bgmuted = true;\n        currentSound.mute(true)\n        mbg.hide();\n        umbg.show();\n      });\n      umbg = createButton(500,560,200,40,'Unmute BG Music', () => {\n        bgmuted = false;\n        currentSound.mute(false)\n        mbg.show();\n        umbg.hide();\n      });\n      if (bgmuted) mbg.hide();\n      else umbg.hide();\n      createButton(500,620,200,40,'Help', () => {\n        window.open('https://toniqlabs.gitbook.io/rise-of-the-magni/', '_blank').focus();\n      });\n      createButton(500,680,200,40,'Back', () => {\n        setTimeout(() => rooms.menu.enter(), 100);\n      });\n    },\n    exit : () => {\n      currentRoom.draw.clear();\n    }\n  },\n  adventure : {\n    draw : INNERDRAW.group(),\n    chapter : false,\n    stage : false,\n    scene : false,\n    clickHandler : false,\n    inAdventureMode : false,\n    enter : (c,s) => {\n      if (currentRoom) currentRoom.exit();\n      currentRoom = rooms.adventure;\n      if (rooms.adventure.inAdventureMode) {\n        currentRoom.draw.show();\n      } else {\n        rooms.adventure.inAdventureMode = true;\n        currentRoom.draw.clear();\n        \n        rooms.adventure.scene = currentRoom.draw.group();\n        \n        rooms.adventure.chapter = 0;\n        rooms.adventure.stage = 0;\n        \n        launchAdventure(c,s);\n      }\n    },\n    exit : () => {\n      if (!rooms.adventure.inAdventureMode)\n        currentRoom.draw.clear();\n      else\n        currentRoom.draw.hide();\n    },\n    click : (offsetX, offsetY) => {\n      if (rooms.adventure.clickHandler) {\n        rooms.adventure.clickHandler();\n      }\n    }\n  },\n  lobby : {\n    headerMessage : false,\n    draw : INNERDRAW.group(),\n    hexClickHandler : (offsetX, offsetY, hex) => {\n      if (state != \"free\") return;\n      if (currentRoom != rooms.lobby) return;\n      if (!buttonIsFree) return;\n      buttonIsFree = false;\n      var hexCoordinates = { x : hex.x, y : hex.y };\n      //console.log(hex);\n      if (hex.type == 'hero') {\n        for(var i = 0; i < playergrid.length; i++) {\n          if (playergrid[i].magni == false) {\n            playergrid[i].isPlayerHex = true;\n            playergrid[i].set(hex.magni, CONFIG.colors.hexBg);\n            hex.removeCard();\n            SOUND.select.play();\n            updateSelectedTeam();\n            break;\n          }         \n        }\n      } else if (hex.type == 'team'){\n        if (hex.magni !== false){\n          for(var i = 0; i < herogrid.length; i++) {\n            if (herogrid[i].magni == false) {\n              herogrid[i].set(hex.magni, CONFIG.colors.hexBg);\n              break;\n            }         \n          }\n          hex.removeCard();\n          SOUND.select.play();\n          updateSelectedTeam();\n        }\n      } else if (hex.type == 'special'){\n        var magnitomove = []\n        SOUND.select.play();\n        for(var i = 0; i < playergrid.length; i++) {\n          if (playergrid[i].magni !== false) {\n            magnitomove.push(playergrid[i].magni);\n            playergrid[i].removeCard();\n          } \n        }\n        if (magnitomove.length > 0) {\n          for(var i = 0; i < herogrid.length; i++) {\n            if (herogrid[i].magni == false) {\n              herogrid[i].set(magnitomove.pop(), CONFIG.colors.hexBg);\n              if (magnitomove.length == 0) break;\n            } \n          }\n        }\n        for(var i = 0; i < herogrid.length; i++) {\n          if (CONFIG.starters[hex.magni][1].indexOf(herogrid[i].magni[1].magni) >= 0) {\n            magnitomove.push(herogrid[i].magni);\n            herogrid[i].removeCard();\n            if (magnitomove.length == 10) break;\n          }\n        };\n        for(var i = 0; i < magnitomove.length; i++) {\n          playergrid[i].isPlayerHex = true;\n          playergrid[i].set(magnitomove[i], CONFIG.colors.hexBg);\n        };\n        updateSelectedTeam();\n      }\n      drawCurrentRating();\n      buttonIsFree = true;\n    },\n    gameMode : 0,\n    enter : (gm) => {\n      if (currentRoom) currentRoom.exit();\n      currentRoom = rooms.lobby;\n      currentRoom.draw.clear();\n      state = 'busy';\n      if (typeof gm != 'undefined' && gm !== false) rooms.lobby.gameMode = gm;\n      setBackground('assets/bgs/lobby.jpg');\n      drawMessage(\"Select your team!\");\n      \n      //Buttons\n      var createBtn, joinBtn, playOnlineBtn, backBtn, cancelBtn;\n      if (rooms.lobby.gameMode == 0){\n        createButton(1020,10,150,40,'Start Adventure', function(){\n          if (isValidTeam()) {\n            rooms.adventure.enter(0,0);\n          } else {\n            alert(\"Please select a full team with a rating of 23 or less\");\n          }\n        });  \n      } else if (rooms.lobby.gameMode == 1){\n        createButton(1020,10,150,40,'Start Training', function(){\n          if (isValidTeam()) {\n            if (state != 'free') return;\n            showLoader();\n            ROTM.gamePractise(selectedTeam, updateGameState).then(() => {\n              rooms.game.enter();\n              SOUND.alert.play();\n              ROTM._stopPolling();\n              state = 'busy';\n            }).catch(e => {\n              state = 'free';\n              alert(e);\n            }).finally(() => {\n              hideLoader();\n            });\n          } else {\n            alert(\"Please select a full team with a rating of 23 or less\");\n          }\n        });        \n      } else if (rooms.lobby.gameMode == 2){\n        createBtn = createButton(850,10,150,40,'Create Game', () => {\n          if (isValidTeam()) {\n            if (state != 'free') return;\n            showLoader();\n            var id =  makeid(5);\n            ROTM.gameCreate(selectedTeam, id, updateGameState).then(() => {\n              state = 'find';\n              drawMessage(\"Waiting - Room code: \" + id);\n              playOnlineBtn.hide();\n              createBtn.hide();\n              joinBtn.hide();\n              backBtn.hide();\n              cancelBtn.show();\n              state = 'busy';\n            }).catch(e => {\n              state = 'free';\n              alert(e);\n            }).finally(() => {\n              hideLoader();\n            });\n          } else {\n            alert(\"Please select a full team with a rating of 23 or less\");\n          }\n        });\n        joinBtn = createButton(850,60,150,40,'Join Game', () => {\n          if (isValidTeam()) {\n            if (state != 'free') return;\n            var id = prompt(\"Please enter room code\", \"\");\n            if (id && id.length == 5) {\n              showLoader();\n              ROTM.gameJoin(selectedTeam, id.toString(), updateGameState).then(() => {\n                state = 'find';\n                drawMessage(\"Joining game...\");\n                playOnlineBtn.hide();\n                createBtn.hide();\n                backBtn.hide();\n                cancelBtn.show();\n                state = 'busy';\n              }).catch(e => {\n                alert(e);\n                state = 'free';\n              }).finally(() => {\n                hideLoader();\n              });\n            } else {\n              alert(\"Please ener a valid room code\");\n            }\n          } else {\n            alert(\"Please select a full team with a rating of 23 or less\");\n          }\n        });\n        playOnlineBtn = createButton(1020,10,150,40,'Matchmaking', () => {\n          if (isValidTeam()) {\n            if (state != 'free') return;\n            showLoader();\n            ROTM.gameFind(selectedTeam, updateGameState).then(() => {\n              state = 'find';\n              drawMessage(\"Finding a match...\");\n              playOnlineBtn.hide();\n              createBtn.hide();\n              joinBtn.hide();\n              backBtn.hide();\n              cancelBtn.show();\n              state = 'busy';\n            }).catch(e => {\n              state = 'free';\n              alert(e);\n            }).finally(() => {\n              hideLoader();\n            });\n          } else {\n            alert(\"Please select a full team with a rating of 23 or less\");\n          }\n        });\n        cancelBtn = createButton(1020,60,150,40,'Cancel', () => {\n          showLoader();\n          ROTM.gameLeave().then(() => {\n            state = 'free';\n            drawMessage(\"Select your team!\");\n            cancelBtn.hide();\n            playOnlineBtn.show();\n            createBtn.show();\n            joinBtn.show();\n            backBtn.show();\n          }).catch(e => {\n            alert(e);\n          }).finally(() => {\n            hideLoader();\n          });\n        });\n        cancelBtn.hide();\n        \n      }\n      \n      backBtn = createButton(1020,60,150,40,'Back', function(){\n        rooms.menu.enter();\n      });  \n      \n      selectedHex = false;\n      herogrid.map((hex, i) => {\n        hex.init('hero', currentRoom.draw.group());\n        if (i < mymagni.length) {\n          if (selectedTeam.indexOf(mymagni[i]) < 0) hex.set(mymagni[i], CONFIG.colors.hexBg);\n        }\n      });\n      playergrid.map((hex, i) => {\n        hex.isPlayerHex = true;\n        hex.init('team', currentRoom.draw.group());\n        if (selectedTeam.length > i)\n          hex.set(selectedTeam[i], CONFIG.colors.hexBg);\n      });\n      premadegrid.map((hex, i) => {\n        hex.init('special', currentRoom.draw.group());\n        hex.special(CONFIG.starters[i][0], i);\n      });\n      drawCurrentRating()\n      state = 'free';\n    },\n    click : (offsetX, offsetY) => {\n\n    },\n    exit : () => {\n      currentRoom.draw.clear();\n      currentRoom.headerMessage = false;\n      omd = false;\n      rd = false;\n    }\n  },\n  game : {\n    headerMessage : false,\n    draw : INNERDRAW.group(),\n    hexClickHandler : (offsetX, offsetY, hex) => {\n      if (gameState == 3) return;\n      var hexCoordinates = { x : hex.x, y : hex.y };\n      if (gameState == 0){\n        if (hex.type == 'team') {\n          selectedHex = hex;\n          selectedHex.highlight(CONFIG.colors.ally)\n          gameState = 1;\n          drawMessage(\"Waiting for other player...\");\n          ROTM.gameMove(selectedHex.magni);\n          SOUND.select.play();\n        }\n      } else if (gameState == 2){\n        if (isPlayersTurn){\n          if (hex.type == 'game') {\n            if (hex.player == 0){\n              if (selectedHex) {\n                ROTM.gameMove(selectedHex.magni, hex.index);\n                hex.isPlayerHex = true;\n                isPlayersTurn = false;\n                hex.place(currentPlayer, selectedHex.magni, CONFIG.colors.ally);\n                SOUND.place.play();\n                placeHex(hex, true);\n                selectedHex.clear();\n                drawMessage(\"Waiting for other player...\");\n              }\n            }\n          }\n          if (hex.type == 'team' && hex.magni !== false) {\n            if (selectedHex) selectedHex.unhighlight();\n            hex.highlight(CONFIG.colors.ally)\n            selectedHex = hex;\n            SOUND.select.play();\n          }\n        }\n      }\n    },\n    character : false,\n    board : false,\n    result : 0,\n    playerScore : 0,\n    opponentScore : 0,\n    enter : (bbt, bbfn, board, character) => {\n      if (currentRoom) currentRoom.exit();\n      currentRoom = rooms.game;\n      currentRoom.draw.clear();\n      localScore = [0,0];\n      bgmusic('battle');\n      setBackground('assets/bgs/arena.jpg');\n      selectedHex = false;\n      gameState = 0;\n      movesMade = 0;\n      if (character) rooms.game.character = character;\n      if (!bbt) bbt = \"Back\";\n      if (!bbfn) bbfn = (r) => {    \n        bgmusic('lobby');\n        ROTM.gameEnd();\n        rooms.lobby.enter()\n      };\n      if (!board) board = CONFIG.boards.standard;\n      gamegrid = Grid(board);\n      rooms.game.board = board;\n      rooms.game.backButton = createButton(1020,10,150,40, bbt, () => {\n        bbfn(rooms.game.result);\n      });\n      rooms.game.backButton.hide();\n      \n      //Draw game grid\n      gamegrid.map((hex, i) => {\n        hex.index = i;\n        hex.magni = false;\n        hex.player = 0;\n        hex.init('game', currentRoom.draw.group());\n      });\n      var c = 0;\n      playergrid.map(hex => {\n        hex.isPlayerHex = true;\n        hex.init('team', currentRoom.draw.group());\n        hex.set(selectedTeam[c++], CONFIG.colors.hexBg);\n      });\n      \n      //Reset variables\n      drawMessage(\"Game found - Select your Strike Unit\");\n    },\n    exit : () => {\n      currentRoom.draw.clear();\n      currentRoom.headerMessage = false;\n      st1 = false;\n      st2 = false;\n      omd = false;\n    }\n  }\n}\nwindow.rooms = rooms;\nwindow.ROTM = ROTM;\n\n\nwindow.SOUND = {\n  alert : new Howl({src: ['assets/sounds/alert.mp3']}),\n  battle : new Howl({src: ['assets/sounds/battle.wav']}),\n  lobby : new Howl({src: ['assets/sounds/lobby.wav']}),\n  lose : new Howl({src: ['assets/sounds/lose.wav']}),\n  place : new Howl({src: ['assets/sounds/place.wav']}),\n  select : new Howl({src: ['assets/sounds/select.mp3']}),\n  win : new Howl({src: ['assets/sounds/win.mp3']}),\n};\nSOUND.battle.volume(0.5);\nSOUND.alert.volume(0.2);\nSOUND.select.volume(0.4);\nSOUND.place.volume(0.1);\nSOUND.lose.volume(0.1);\nSOUND.win.volume(0.1);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdO = {};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t296: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) var result = runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkrotm_v2\"] = self[\"webpackChunkrotm_v2\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [38], () => (__webpack_require__(5872)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"sourceRoot":""}